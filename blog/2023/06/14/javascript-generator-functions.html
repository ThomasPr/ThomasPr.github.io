<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Leveraging the Power of JavaScript Generator Functions: Keep Database Batch Operations clean and maintainable - Thomas’ Blog</title>
<meta name="description" content="In Node.js applications, querying a database in batches can be a common requirement when dealing with large datasets. Generator functions can streamline the process of querying a database in batches to keep the code clean and maintainable.">


  <meta name="author" content="Thomas Preißler">
  
  <meta property="article:author" content="Thomas Preißler">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Thomas' Blog">
<meta property="og:title" content="Leveraging the Power of JavaScript Generator Functions: Keep Database Batch Operations clean and maintainable">
<meta property="og:url" content="https://thomas.preissler.me/blog/2023/06/14/javascript-generator-functions">


  <meta property="og:description" content="In Node.js applications, querying a database in batches can be a common requirement when dealing with large datasets. Generator functions can streamline the process of querying a database in batches to keep the code clean and maintainable.">







  <meta property="article:published_time" content="2023-06-14T20:00:00+00:00">





  

  


<link rel="canonical" href="https://thomas.preissler.me/blog/2023/06/14/javascript-generator-functions">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Thomas Preißler",
      "url": "https://thomas.preissler.me/",
      "sameAs": ["https://twitter.com/TheThomasPr","https://github.com/ThomasPr","https://stackoverflow.com/users/915955/thomas-prei%c3%9fler","https://www.xing.com/profile/Thomas_Preissler","https://www.linkedin.com/in/thomas-preissler/"]
    
  }
</script>


  <meta name="google-site-verification" content="VhaciMaca92rdlXRrqBBFXCR1hxERcyhW4Kqq7XafWM" />






<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Thomas' Blog Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <link rel="icon" href="/assets/images/thomas.jpg" type="image/jpeg" />

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@TheThomasPr">

<script src="https://cdn.counter.dev/script.js" data-id="3fd1c66f-09ab-4cc3-8b8d-e9a577c8a82c" data-utcoffset="1"></script>

  </head>

  <body class="layout--single wide">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Thomas' Blog
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/">Blog</a>
            </li><li class="masthead__menu-item">
              <a href="/about">About</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="https://thomas.preissler.me/">
        <img src="/assets/images/thomas.jpg" alt="Thomas Preißler" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://thomas.preissler.me/" itemprop="url">Thomas Preißler</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>software developer,<br />addicted to KISS</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Freiburg, Germany</span>
        </li>
      

      
        
          
            <li><a href="https://www.haufe-akademie.de/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fas fa-fw fa-building" aria-hidden="true"></i><span class="label">Haufe Akademie</span></a></li>
          
        
          
            <li><a href="mailto:thomas@preissler.me" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://twitter.com/TheThomasPr" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://github.com/ThomasPr" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://stackoverflow.com/users/915955/thomas-prei%c3%9fler" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-stack-overflow" aria-hidden="true"></i><span class="label">Stack Overflow</span></a></li>
          
        
          
            <li><a href="https://www.xing.com/profile/Thomas_Preissler" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-xing" aria-hidden="true"></i><span class="label">Xing</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/thomas-preissler" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Leveraging the Power of JavaScript Generator Functions: Keep Database Batch Operations clean and maintainable">
    <meta itemprop="description" content="In Node.js applications, querying a database in batches can be a common requirement when dealing with large datasets. Generator functions can streamline the process of querying a database in batches to keep the code clean and maintainable.">
    <meta itemprop="datePublished" content="2023-06-14T20:00:00+00:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="https://thomas.preissler.me/blog/2023/06/14/javascript-generator-functions" class="u-url" itemprop="url">Leveraging the Power of JavaScript Generator Functions: Keep Database Batch Operations clean and maintainable
</a>
          </h1>
          

  <p class="page__meta">
    
      
      <span class="page__meta-date">
        <i class="far fa-calendar-alt" aria-hidden="true"></i>
        
        <time datetime="2023-06-14T20:00:00+00:00">June 14, 2023</time>
      </span>
    

    

    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
        <p><strong>In Node.js applications, querying a database in batches can be a common requirement when dealing with large datasets. In this blog post, we’ll explore how generator functions can streamline the process of querying a database in batches to keep the code clean and maintainable.</strong></p>

<p>The blog post is divided into 4 parts:</p>

<ol>
  <li><a href="#1-integrate-opentelemetry-into-the-quarkus-application">Without Batch Operations</a></li>
  <li><a href="#2-querying-in-batches-without-generator-functions">Querying in Batches without Generator Functions</a></li>
  <li><a href="#3-querying-in-batches-with-generator-functions">Querying in Batches with Generator Functions</a></li>
  <li><a href="#4-clean-code-extract-the-batch-logic-into-its-own-function">Clean Code: Extract the batch logic into its own function</a></li>
</ol>

<h2 id="1-without-batch-operations">1. Without Batch Operations</h2>

<p>Suppose we want to send a notification to all our users, we would need to retrieve all users from the database using TypeORM, iterate over each individual user and send the actual notification. The code is clean and split up into the more general function <code class="language-plaintext highlighter-rouge">sendOfferToUsers()</code>, whereas the database query logic is encapsulated into <code class="language-plaintext highlighter-rouge">findAllConfirmedUsers()</code></p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">sendOfferToUsers</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">user</span> <span class="k">of</span> <span class="k">await</span> <span class="nx">findAllConfirmedUsers</span><span class="p">())</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">message</span> <span class="o">=</span> <span class="s2">`Special Offer just for </span><span class="p">${</span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
    <span class="k">await</span> <span class="nx">notifyUser</span><span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span> <span class="nx">message</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">async</span> <span class="kd">function</span> <span class="nx">findAllConfirmedUsers</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">await</span> <span class="nx">userRepository</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span>
    <span class="na">where</span><span class="p">:</span> <span class="p">{</span> <span class="na">confirmed</span><span class="p">:</span> <span class="kc">true</span> <span class="p">}</span>
  <span class="p">});</span>
<span class="p">}</span>

<span class="k">async</span> <span class="kd">function</span> <span class="nx">notifyUser</span><span class="p">(</span><span class="nx">email</span><span class="p">:</span> <span class="kr">string</span><span class="p">,</span> <span class="nx">message</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// omitted for the brevity</span>
<span class="p">}</span>
</code></pre></div></div>

<p>While this approach works fine for smaller datasets, it becomes inefficient and memory-intensive when dealing with larger ones. To address this issue, we need to query the database in batches.</p>

<h2 id="2-querying-in-batches-without-generator-functions">2. Querying in Batches without Generator Functions</h2>

<p>To efficiently query large datasets from a database, it’s necessary to retrieve the data in subsets rather than all at once. This is achieved through batch operations, which involve querying the database multiple times and limiting the returned rows to a specific number while skipping the previously fetched rows.</p>

<p>TypeORM allows us to set take and skip attributes for batch querying, but it requires explicit configuration. Here’s an example of implementing batch operations</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">sendOfferToUsers</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">batchSize</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">;</span>
  <span class="kd">let</span> <span class="nx">batchIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kd">let</span> <span class="nx">users</span><span class="p">:</span> <span class="nx">User</span><span class="p">[];</span>

  <span class="k">do</span> <span class="p">{</span>
    <span class="nx">users</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">findAllConfirmedUsers</span><span class="p">(</span><span class="nx">batchSize</span><span class="p">,</span> <span class="nx">batchIndex</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">user</span> <span class="k">of</span> <span class="nx">users</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">message</span> <span class="o">=</span> <span class="s2">`Special Offer just for </span><span class="p">${</span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
      <span class="k">await</span> <span class="nx">notifyUser</span><span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span> <span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">batchIndex</span><span class="o">++</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="nx">users</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="nx">batchSize</span><span class="p">);</span>

<span class="p">}</span>

<span class="k">async</span> <span class="kd">function</span> <span class="nx">findAllConfirmedUsers</span><span class="p">(</span><span class="nx">batchSize</span><span class="p">:</span> <span class="kr">number</span><span class="p">,</span> <span class="nx">batchIndex</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">await</span> <span class="nx">userRepository</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span>
    <span class="na">where</span><span class="p">:</span> <span class="p">{</span> <span class="na">confirmed</span><span class="p">:</span> <span class="kc">true</span> <span class="p">},</span>
    <span class="na">take</span><span class="p">:</span> <span class="nx">batchSize</span><span class="p">,</span>
    <span class="na">skip</span><span class="p">:</span> <span class="nx">batchIndex</span> <span class="o">*</span> <span class="nx">batchSize</span>
  <span class="p">});</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Obviously, the code is less readable than the previous example due to littering the batch operation from the database-specific method <code class="language-plaintext highlighter-rouge">findAllConfirmedUsers()</code> into <code class="language-plaintext highlighter-rouge">sendOfferToUsers()</code>. But I want to keep all database-related code in the <code class="language-plaintext highlighter-rouge">findAllConfirmedUsers()</code> to seperate the different levels. To solve this issue, we need to employ a generator function.</p>

<h2 id="3-querying-in-batches-with-generator-functions">3. Querying in Batches with Generator Functions</h2>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">sendOfferToUsers</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">for</span> <span class="k">await</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">user</span> <span class="k">of</span> <span class="nx">findAllConfirmedUsers</span><span class="p">())</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">message</span> <span class="o">=</span> <span class="s2">`Special Offer just for </span><span class="p">${</span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
    <span class="k">await</span> <span class="nx">notifyUser</span><span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span> <span class="nx">message</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">async</span> <span class="kd">function</span><span class="o">*</span> <span class="nx">findAllConfirmedUsers</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">batchSize</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">;</span>
  <span class="kd">let</span> <span class="nx">batchIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kd">let</span> <span class="nx">users</span><span class="p">:</span> <span class="nx">User</span><span class="p">[];</span>

  <span class="k">do</span> <span class="p">{</span>
    <span class="nx">users</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">userRepository</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span>
      <span class="na">where</span><span class="p">:</span> <span class="p">{</span> <span class="na">confirmed</span><span class="p">:</span> <span class="kc">true</span> <span class="p">},</span>
      <span class="na">take</span><span class="p">:</span> <span class="nx">batchSize</span><span class="p">,</span>
      <span class="na">skip</span><span class="p">:</span> <span class="nx">batchIndex</span> <span class="o">*</span> <span class="nx">batchSize</span>
    <span class="p">});</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">user</span> <span class="k">of</span> <span class="nx">users</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">yield</span> <span class="nx">user</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">batchIndex</span><span class="o">++</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="nx">users</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="nx">batchSize</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>By using a generator function, the code becomes readable and maintainable again. The <code class="language-plaintext highlighter-rouge">sendOfferToUsers()</code> function remains clean and focuses on the core logic, while the batch query details are encapsulated in the <code class="language-plaintext highlighter-rouge">findAllConfirmedUsers()</code> generator function.</p>

<p>The generator function is a special type of function that can be paused and resumed during execution, allowing for the generation of a sequence of values. <code class="language-plaintext highlighter-rouge">findAllConfirmedUsers()</code> retrieves users from the database in batches and yields one user at a time. The <code class="language-plaintext highlighter-rouge">for await...of</code> loop in the <code class="language-plaintext highlighter-rouge">sendOfferToUsers()</code> function then iterates over the generated values, providing a clean and readable way to process each user without loading the entire dataset into memory. The code becomes more efficient and memory-friendly when dealing with large datasets.</p>

<h2 id="4-clean-code-extract-the-batch-logic-into-its-own-function">4. Clean Code: Extract the batch logic into its own function</h2>

<p>To further improve the code I want to extract the batch logic into its own method to make it reusable. It should be used to fetch arbritary entities in batches without the need to copy the batch logic.</p>

<div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">async</span> <span class="kd">function</span> <span class="nx">sendOfferToUsers</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">for</span> <span class="k">await</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">user</span> <span class="k">of</span> <span class="nx">findAllConfirmedUsers</span><span class="p">())</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">message</span> <span class="o">=</span> <span class="s2">`Special Offer just for </span><span class="p">${</span><span class="nx">user</span><span class="p">.</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>
    <span class="k">await</span> <span class="nx">notifyUser</span><span class="p">(</span><span class="nx">user</span><span class="p">.</span><span class="nx">email</span><span class="p">,</span> <span class="nx">message</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">async</span> <span class="kd">function</span><span class="o">*</span> <span class="nx">findAllConfirmedUsers</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">yield</span><span class="o">*</span> <span class="nx">findInBatches</span><span class="p">(</span><span class="nx">userRepository</span><span class="p">,</span> <span class="p">{</span> <span class="na">where</span><span class="p">:</span> <span class="p">{</span> <span class="na">confirmed</span><span class="p">:</span> <span class="kc">true</span> <span class="p">}</span> <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">async</span> <span class="kd">function</span><span class="o">*</span> <span class="nx">findInBatches</span><span class="o">&lt;</span><span class="nx">T</span> <span class="kd">extends</span> <span class="nx">ObjectLiteral</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">repository</span><span class="p">:</span> <span class="nx">Repository</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">,</span> <span class="nx">findOptions</span><span class="p">:</span> <span class="nx">FindManyOptions</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">,</span> <span class="nx">batchSize</span><span class="p">:</span> <span class="kr">number</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">batchIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kd">let</span> <span class="nx">entities</span><span class="p">:</span> <span class="nx">T</span><span class="p">[];</span>
  <span class="k">do</span> <span class="p">{</span>
    <span class="nx">entities</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">repository</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span>
      <span class="na">take</span><span class="p">:</span> <span class="nx">batchSize</span><span class="p">,</span>
      <span class="na">skip</span><span class="p">:</span> <span class="nx">batchIndex</span> <span class="o">*</span> <span class="nx">batchSize</span><span class="p">,</span>
      <span class="p">...</span><span class="nx">findOptions</span>
    <span class="p">});</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">const</span> <span class="nx">entity</span> <span class="k">of</span> <span class="nx">entities</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">yield</span> <span class="nx">entity</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">batchIndex</span><span class="o">++</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="nx">entities</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="nx">batchSize</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">yield*</code> keyword is used to delegate the iteration control from one generator function to another. In the <code class="language-plaintext highlighter-rouge">findAllConfirmedUsers()</code> function, yield* <code class="language-plaintext highlighter-rouge">findInBatches()</code> is used to delegate the iteration over the batched users to the <code class="language-plaintext highlighter-rouge">findInBatches()</code> generator function. This allows for a clean separation of concerns, where the <code class="language-plaintext highlighter-rouge">findAllConfirmedUsers()</code> function focuses on retrieving users from the database, while the <code class="language-plaintext highlighter-rouge">findInBatches()</code> function handles the batch querying logic.</p>

<h2 id="conclusion">Conclusion</h2>

<p>In Node.js applications, querying a database in batches is essential for handling large datasets efficiently. By utilizing generator functions, we can simplify the code, improve readability, and maintainability. The extracted batch logic also promotes clean code organization and reusability. Generator functions are a powerful language feature that I just learned about a few weeks ago.</p>

        
      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2023-06-14T20:00:00+00:00">June 14, 2023</time></p>

      </footer>

      

      
    </div>

    
  </article>

  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://github.com/ThomasPr/ThomasPr.github.io" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Thomas Preißler. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>










  </body>
</html>
